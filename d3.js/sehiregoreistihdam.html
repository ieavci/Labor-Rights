<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Graph</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

</head>

<body>
    <svg width="800" height="600"></svg>

    <script>
        // Şehir verileri
        const citiesData = [
            { il: "İstanbul", Tarım: 0.6, Sanayi: 31.5, Hizmet: 68 },
            { il: "Tekirdağ", Tarım: 15.4, Sanayi: 38.7, Hizmet: 45.9 },
            { il: "Balıkesir", Tarım: 21.8, Sanayi: 24, Hizmet: 54.2 },
            { il: "Çanakkale", Tarım: 21.8, Sanayi: 24, Hizmet: 54.2 },
            { il: "İzmir", Tarım: 7.4, Sanayi: 32.4, Hizmet: 60.2 },
            { il: "Aydın", Tarım: 20.6, Sanayi: 23.8, Hizmet: 55.6 },
            { il: "Denizli", Tarım: 20.6, Sanayi: 23.8, Hizmet: 55.6 },
            { il: "Muğla", Tarım: 20.6, Sanayi: 23.8, Hizmet: 55.6 },
            { il: "Manisa", Tarım: 30.6, Sanayi: 29.2, Hizmet: 40.1 },
            { il: "Afyonkarahisar", Tarım: 30.6, Sanayi: 29.2, Hizmet: 40.1 },
            { il: "Kütahya", Tarım: 30.6, Sanayi: 29.2, Hizmet: 40.1 },
            { il: "Uşak", Tarım: 30.6, Sanayi: 29.2, Hizmet: 40.1 },
            { il: "Bursa", Tarım: 7.3, Sanayi: 40.9, Hizmet: 51.8 },
            { il: "Eskişehir", Tarım: 7.3, Sanayi: 40.9, Hizmet: 51.8 },
            { il: "Bilecik", Tarım: 7.3, Sanayi: 40.9, Hizmet: 51.8 },
            { il: "Sakarya", Tarım: 12.1, Sanayi: 37, Hizmet: 50.9 },
            { il: "Kocaeli", Tarım: 12.1, Sanayi: 37, Hizmet: 50.9 },
            { il: "Düzce", Tarım: 12.1, Sanayi: 37, Hizmet: 50.9 },
            { il: "Bolu", Tarım: 12.1, Sanayi: 37, Hizmet: 50.9 },
            { il: "Yalova", Tarım: 12.1, Sanayi: 37, Hizmet: 50.9 },
            { il: "Ankara", Tarım: 3.1, Sanayi: 25.4, Hizmet: 71.4 },
            { il: "Konya", Tarım: 24.9, Sanayi: 29.2, Hizmet: 45.9 },
            { il: "Karaman", Tarım: 24.9, Sanayi: 29.2, Hizmet: 45.9 },
            { il: "Antalya", Tarım: 17.1, Sanayi: 15.4, Hizmet: 67.5 },
            { il: "Isparta", Tarım: 17.1, Sanayi: 15.4, Hizmet: 67.5 },
            { il: "Burdur", Tarım: 17.1, Sanayi: 15.4, Hizmet: 67.5 },
            { il: "Adana", Tarım: 16.9, Sanayi: 24.8, Hizmet: 58.2 },
            { il: "Mersin", Tarım: 16.9, Sanayi: 24.8, Hizmet: 58.2 },
            { il: "Hatay", Tarım: 18.3, Sanayi: 25.1, Hizmet: 56.7 },
            { il: "Kahramanmaraş", Tarım: 18.3, Sanayi: 25.1, Hizmet: 56.7 },
            { il: "Osmaniye", Tarım: 18.3, Sanayi: 25.1, Hizmet: 56.7 },
            { il: "Kırıkkale", Tarım: 27.1, Sanayi: 21.2, Hizmet: 51.7 },
            { il: "Aksaray", Tarım: 27.1, Sanayi: 21.2, Hizmet: 51.7 },
            { il: "Niğde", Tarım: 27.1, Sanayi: 21.2, Hizmet: 51.7 },
            { il: "Nevşehir", Tarım: 27.1, Sanayi: 21.2, Hizmet: 51.7 },
            { il: "Kırşehir", Tarım: 27.1, Sanayi: 21.2, Hizmet: 51.7 },
            { il: "Kayseri", Tarım: 20.4, Sanayi: 26.1, Hizmet: 53.5 },
            { il: "Sivas", Tarım: 20.4, Sanayi: 26.1, Hizmet: 53.5 },
            { il: "Yozgat", Tarım: 20.4, Sanayi: 26.1, Hizmet: 53.5 },
            { il: "Zonguldak", Tarım: 21.7, Sanayi: 28.8, Hizmet: 49.5 },
            { il: "Karabük", Tarım: 21.7, Sanayi: 28.8, Hizmet: 49.5 },
            { il: "Bartın", Tarım: 21.7, Sanayi: 28.8, Hizmet: 49.5 },
            { il: "Kastamonu", Tarım: 37.3, Sanayi: 17.7, Hizmet: 45 },
            { il: "Çankırı", Tarım: 37.3, Sanayi: 17.7, Hizmet: 45 },
            { il: "Sinop", Tarım: 37.3, Sanayi: 17.7, Hizmet: 45 },
            { il: "Samsun", Tarım: 34.7, Sanayi: 20.1, Hizmet: 45.2 },
            { il: "Tokat", Tarım: 34.7, Sanayi: 20.1, Hizmet: 45.2 },
            { il: "Çorum", Tarım: 34.7, Sanayi: 20.1, Hizmet: 45.2 },
            { il: "Amasya", Tarım: 34.7, Sanayi: 20.1, Hizmet: 45.2 },
            { il: "Trabzon", Tarım: 39.6, Sanayi: 17.3, Hizmet: 43.1 },
            { il: "Ordu", Tarım: 39.6, Sanayi: 17.3, Hizmet: 43.1 },
            { il: "Giresun", Tarım: 39.6, Sanayi: 17.3, Hizmet: 43.1 },
            { il: "Rize", Tarım: 39.6, Sanayi: 17.3, Hizmet: 43.1 },
            { il: "Artvin", Tarım: 39.6, Sanayi: 17.3, Hizmet: 43.1 },
            { il: "Gümüşhane", Tarım: 39.6, Sanayi: 17.3, Hizmet: 43.1 },
            { il: "Erzurum", Tarım: 37.3, Sanayi: 12.3, Hizmet: 50.4 },
            { il: "Erzincan", Tarım: 37.3, Sanayi: 12.3, Hizmet: 50.4 },
            { il: "Bayburt", Tarım: 37.3, Sanayi: 12.3, Hizmet: 50.4 },
            { il: "Ağrı", Tarım: 48.1, Sanayi: 12.4, Hizmet: 39.4 },
            { il: "Kars", Tarım: 48.1, Sanayi: 12.4, Hizmet: 39.4 },
            { il: "Iğdır", Tarım: 48.1, Sanayi: 12.4, Hizmet: 39.4 },
            { il: "Ardahan", Tarım: 48.1, Sanayi: 12.4, Hizmet: 39.4 },
            { il: "Malatya", Tarım: 28.2, Sanayi: 19.7, Hizmet: 52.1 },
            { il: "Elazığ", Tarım: 28.2, Sanayi: 19.7, Hizmet: 52.1 },
            { il: "Bingöl", Tarım: 28.2, Sanayi: 19.7, Hizmet: 52.1 },
            { il: "Tunceli", Tarım: 28.2, Sanayi: 19.7, Hizmet: 52.1 },
            { il: "Van", Tarım: 34.4, Sanayi: 23.9, Hizmet: 41.7 },
            { il: "Muş", Tarım: 34.4, Sanayi: 23.9, Hizmet: 41.7 },
            { il: "Bitlis", Tarım: 34.4, Sanayi: 23.9, Hizmet: 41.7 },
            { il: "Hakkari", Tarım: 34.4, Sanayi: 23.9, Hizmet: 41.7 },
            { il: "Gaziantep", Tarım: 15.2, Sanayi: 33.6, Hizmet: 51.2 },
            { il: "Adıyaman", Tarım: 15.2, Sanayi: 33.6, Hizmet: 51.2 },
            { il: "Kilis", Tarım: 15.2, Sanayi: 33.6, Hizmet: 51.2 },
            { il: "Şanlıurfa", Tarım: 28.8, Sanayi: 23.4, Hizmet: 47.9 },
            { il: "Diyarbakır", Tarım: 28.8, Sanayi: 23.4, Hizmet: 47.9 },
            { il: "Mardin", Tarım: 19.6, Sanayi: 23.1, Hizmet: 57.2 },
            { il: "Batman", Tarım: 19.6, Sanayi: 23.1, Hizmet: 57.2 },
            { il: "Şırnak", Tarım: 19.6, Sanayi: 23.1, Hizmet: 57.2 },
            { il: "Siirt", Tarım: 19.6, Sanayi: 23.1, Hizmet: 57.2 },
            { il: "Edirne", Tarım: 15.4, Sanayi: 38.7, Hizmet: 45.9 },
        ];

        // SVG alanı oluştur
        const svg = d3.select("svg");
        const width = +svg.attr("width");
        const height = +svg.attr("height");

        // Düğümleri ve kenarları oluşturmak için kullanılacak veri yapısı
        const nodes = citiesData.map(city => ({ id: city.il, group: 1 }));
        const categories = ["Tarım", "Sanayi", "Hizmet"];
        const categoriesNodes = categories.map((category, index) => ({ id: category, group: 2, x: width / 2, y: height / (categories.length + 1) * (index + 1) }));

        const links = [];
        citiesData.forEach(city => {
            categories.forEach(category => {
                links.push({ source: city.il, target: category, value: city[category] });
            });
        });

        // Düğümleri ve kenarları birleştir
        const allNodes = [...nodes, ...categoriesNodes];

        // Görselleştirme
        const link = svg.append("g")
            .attr("stroke", "#999")
            .attr("stroke-opacity", 0.6)
            .selectAll("line")
            .data(links)
            .join("line")
            .attr("stroke-width", d => Math.sqrt(d.value));

        const node = svg.append("g")
            .selectAll("circle")
            .data(allNodes)
            .join("circle")
            .attr("r", d => d.group === 1 ? 5 : 10)
            .attr("fill", d => d.group === 1 ? "#1f77b4" : "#ff7f0e")
            .call(drag());

        node.append("title")
            .text(d => d.id);

        const simulation = d3.forceSimulation(allNodes)
            .force("link", d3.forceLink(links).id(d => d.id).distance(50))
            .force("charge", d3.forceManyBody().strength(-100))
            .force("center", d3.forceCenter(width / 2, height / 2));

        simulation.on("tick", () => {
            link.attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);

            node.attr("cx", d => d.x)
                .attr("cy", d => d.y);
        });

        // Sürükleme fonksiyonu
        function drag() {
            function dragstarted(event) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                event.subject.fx = event.subject.x;
                event.subject.fy = event.subject.y;
            }

            function dragged(event) {
                event.subject.fx = event.x;
                event.subject.fy = event.y;
            }

            function dragended(event) {
                if (!event.active) simulation.alphaTarget(0);
                event.subject.fx = null;
                event.subject.fy = null;
            }

            return d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended);
        }

        // Tıklama olayını dinleyen fonksiyonu güncelle
        // Düğümlere mouse olaylarını ekle
        node.attr("cursor", "pointer")
            .on("click", handleClick);



        // Tıklama olayını işleyen fonksiyon
        // Tıklama olayını işleyen fonksiyon
        function handleClick(event, d) {
            const cityName = d.id; // Düğümün il ismini al
            const cityData = citiesData.find(city => city.il === cityName); // Şehir verilerini bul

            // Bilgileri kontrol et
            console.log(cityData);

            // Eğer veri bulunduysa bilgileri göster
            if (cityData) {
                let infoText = `İl: ${cityData.il}\n`;
                infoText += `Tarım: ${cityData.Tarım || "Bilgi Yok"}%\n`;
                infoText += `Sanayi: ${cityData.Sanayi || "Bilgi Yok"}%\n`;
                infoText += `Hizmet: ${cityData.Hizmet || "Bilgi Yok"}%`;

                // Modal içeriğini oluştur
                const modalContent = `
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Şehir Bilgileri</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <p>${infoText}</p>
                    </div>
                </div>
            </div>
        `;

                // Modalı oluştur
                const modalElement = document.createElement("div");
                modalElement.innerHTML = modalContent;

                // Modalı body elementine ekle
                document.body.appendChild(modalElement);

                // Bootstrap modal'ı göster
                var myModal = new bootstrap.Modal(modalElement.querySelector('.modal'));
                myModal.show();

                // Modal kapatıldığında temizle
                modalElement.addEventListener('hidden.bs.modal', function () {
                    modalElement.remove(); // Modalı kaldır
                });
            }
        }



    </script>

</body>

</html>