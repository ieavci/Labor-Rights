<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Graph</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>
    <svg width="800" height="600"></svg>

    <script>
        // Veriler
        const data = [
            { year: 2005, population: 48356, labor_force: 21321, employment: 19357, unemployed: 1964, not_in_labor_force: 27035, labor_participation_rate: 44.1, employment_rate: 40, unemployment_rate: 9.2 },
            { year: 2006, population: 49274, labor_force: 21602, employment: 19717, unemployed: 1885, not_in_labor_force: 27672, labor_participation_rate: 43.8, employment_rate: 40, unemployment_rate: 8.7 },
            { year: 2007, population: 50177, labor_force: 21954, employment: 20001, unemployed: 1953, not_in_labor_force: 28223, labor_participation_rate: 43.8, employment_rate: 39.9, unemployment_rate: 8.9 },
            { year: 2008, population: 50981, labor_force: 22628, employment: 20399, unemployed: 2228, not_in_labor_force: 28354, labor_participation_rate: 44.4, employment_rate: 40, unemployment_rate: 9.8 },
            { year: 2009, population: 51833, labor_force: 23588, employment: 20534, unemployed: 3055, not_in_labor_force: 28245, labor_participation_rate: 45.5, employment_rate: 39.6, unemployment_rate: 12.9 },
            { year: 2010, population: 52903, labor_force: 24516, employment: 21810, unemployed: 2705, not_in_labor_force: 28387, labor_participation_rate: 46.3, employment_rate: 41.2, unemployment_rate: 11 },
            { year: 2011, population: 53984, labor_force: 25452, employment: 23166, unemployed: 2287, not_in_labor_force: 28531, labor_participation_rate: 47.1, employment_rate: 42.9, unemployment_rate: 9 },
            { year: 2012, population: 54961, labor_force: 25891, employment: 23738, unemployed: 2153, not_in_labor_force: 29070, labor_participation_rate: 47.1, employment_rate: 43.2, unemployment_rate: 8.3 },
            { year: 2013, population: 55981, labor_force: 26871, employment: 24486, unemployed: 2386, not_in_labor_force: 29110, labor_participation_rate: 48, employment_rate: 43.7, unemployment_rate: 8.9 },
            { year: 2014, population: 56985, labor_force: 28605, employment: 25774, unemployed: 2831, not_in_labor_force: 28379, labor_participation_rate: 50.2, employment_rate: 45.2, unemployment_rate: 9.9 },
            { year: 2015, population: 57870, labor_force: 29550, employment: 26501, unemployed: 3049, not_in_labor_force: 28320, labor_participation_rate: 51.1, employment_rate: 45.8, unemployment_rate: 10.3 },
            { year: 2016, population: 58739, labor_force: 30449, employment: 27126, unemployed: 3323, not_in_labor_force: 28290, labor_participation_rate: 51.8, employment_rate: 46.2, unemployment_rate: 10.9 },
            { year: 2017, population: 59892, labor_force: 31516, employment: 28075, unemployed: 3441, not_in_labor_force: 28377, labor_participation_rate: 52.6, employment_rate: 46.9, unemployment_rate: 10.9 },
            { year: 2018, population: 60653, labor_force: 32203, employment: 28691, unemployed: 3512, not_in_labor_force: 28449, labor_participation_rate: 53.1, employment_rate: 47.3, unemployment_rate: 10.9 },
            { year: 2019, population: 61468, labor_force: 32505, employment: 28042, unemployed: 4463, not_in_labor_force: 28962, labor_participation_rate: 52.9, employment_rate: 45.6, unemployment_rate: 13.7 },
            { year: 2020, population: 62579, labor_force: 30735, employment: 26695, unemployed: 4040, not_in_labor_force: 31844, labor_participation_rate: 49.1, employment_rate: 42.7, unemployment_rate: 13.1 },
            { year: 2021, population: 63704, labor_force: 32716, employment: 28797, unemployed: 3919, not_in_labor_force: 30989, labor_participation_rate: 51.4, employment_rate: 45.2, unemployment_rate: 12 },
            { year: 2022, population: 64679, labor_force: 34334, employment: 30752, unemployed: 3582, not_in_labor_force: 30345, labor_participation_rate: 53.1, employment_rate: 47.5, unemployment_rate: 10.4 }
        ];

        // SVG alanı oluştur
        const svg = d3.select("svg");
        const width = +svg.attr("width");
        const height = +svg.attr("height");

        // Veri işleme
        // Veri işleme
        const nodes = []; // Düğümleri temsil edecek bir dizi oluştur
        const links = []; // Bağlantıları temsil edecek bir dizi oluştur

        // Her yıl için bir düğüm oluştur
        data.forEach((d, i) => {
            nodes.push({ id: "year_" + d.year, group: 1 });
        });

        // Bağlantıları oluştur
        data.forEach((d, i) => {
            if (i < data.length - 1) {
                links.push({ source: "year_" + d.year, target: "year_" + data[i + 1].year, value: d.population });
                links.push({ source: "year_" + d.year, target: "year_" + data[i + 1].year, value: d.labor_force });
                links.push({ source: "year_" + d.year, target: "year_" + data[i + 1].year, value: d.employment });
                links.push({ source: "year_" + d.year, target: "year_" + data[i + 1].year, value: d.unemployed });
                links.push({ source: "year_" + d.year, target: "year_" + data[i + 1].year, value: d.not_in_labor_force });
                links.push({ source: "year_" + d.year, target: "year_" + data[i + 1].year, value: d.labor_participation_rate });
                links.push({ source: "year_" + d.year, target: "year_" + data[i + 1].year, value: d.employment_rate });
                links.push({ source: "year_" + d.year, target: "year_" + data[i + 1].year, value: d.unemployment_rate });
            }
        });

        // Güç belirleyicisi oluştur
        const simulation = d3.forceSimulation(nodes)
            .force("link", d3.forceLink(links).id(d => d.id))
            .force("charge", d3.forceManyBody().strength(-100))
            .force("center", d3.forceCenter(width / 2, height / 2));




        // Görselleştirme
        const link = svg.append("g")
            .attr("stroke", "#999")
            .attr("stroke-opacity", 0.6)
            .selectAll("line")
            .data(links)
            .join("line")
            .attr("stroke-width", d => Math.sqrt(d.value)/20);

        const node = svg.append("g")
            .attr("stroke", "#fff")
            .attr("stroke-width", 1.5)
            .selectAll("circle")
            .data(nodes)
            .join("circle")
            .attr("r", 5)
            .attr("fill", "#1f77b4")
            .call(drag(simulation));

        node.append("title")
            .text(d => d.id);

        simulation.on("tick", () => {
            link
                .attr("x1", d => d.source.x)
                .attr("y1", d => d.source.y)
                .attr("x2", d => d.target.x)
                .attr("y2", d => d.target.y);

            node
                .attr("cx", d => d.x)
                .attr("cy", d => d.y);
        });

        // Sürükleme fonksiyonu
        function drag(simulation) {
            function dragstarted(event) {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                event.subject.fx = event.subject.x;
                event.subject.fy = event.subject.y;
            }

            function dragged(event) {
                event.subject.fx = event.x;
                event.subject.fy = event.y;
            }

            function dragended(event) {
                if (!event.active) simulation.alphaTarget(0);
                event.subject.fx = null;
                event.subject.fy = null;
            }

            return d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended);
        }
    </script>
</body>

</html>